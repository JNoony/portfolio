{"version":3,"file":"lazyloaded.pkgd.js","sources":["../src/consts.ts","../node_modules/@egjs/component/dist/component.esm.js","../src/utils.ts","../src/AutoSizer.ts","../src/LazyLoaded.ts"],"sourcesContent":["const isWindow = typeof window !== \"undefined\";\nconst ua = isWindow ? window.navigator.userAgent : \"\";\nexport const SUPPORT_COMPUTEDSTYLE = isWindow ? !!(\"getComputedStyle\" in window) : false;\nexport const IS_IE = /MSIE|Trident|Windows Phone|Edge/.test(ua);\nexport const SUPPORT_ADDEVENTLISTENER = isWindow ? !!(\"addEventListener\" in document) : false;\nexport const WIDTH = \"width\";\nexport const HEIGHT = \"height\";\n","/*\nCopyright (c) 2017 NAVER Corp.\n@egjs/component project is licensed under the MIT license\n\n@egjs/component JavaScript library\nhttps://naver.github.io/egjs-component\n\n@version 2.1.2\n*/\n/**\n * Copyright (c) 2015 NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nfunction isUndefined(value) {\n  return typeof value === \"undefined\";\n}\n/**\n * A class used to manage events in a component\n * @ko 컴포넌트의 이벤트을 관리할 수 있게 하는 클래스\n * @alias eg.Component\n */\n\n\nvar Component =\n/*#__PURE__*/\nfunction () {\n  var Component =\n  /*#__PURE__*/\n  function () {\n    /**\n    * Version info string\n    * @ko 버전정보 문자열\n    * @name VERSION\n    * @static\n    * @type {String}\n    * @example\n    * eg.Component.VERSION;  // ex) 2.0.0\n    * @memberof eg.Component\n    */\n\n    /**\n     * @support {\"ie\": \"7+\", \"ch\" : \"latest\", \"ff\" : \"latest\",  \"sf\" : \"latest\", \"edge\" : \"latest\", \"ios\" : \"7+\", \"an\" : \"2.1+ (except 3.x)\"}\n     */\n    function Component() {\n      this._eventHandler = {};\n      this.options = {};\n    }\n    /**\n     * Triggers a custom event.\n     * @ko 커스텀 이벤트를 발생시킨다\n     * @param {String} eventName The name of the custom event to be triggered <ko>발생할 커스텀 이벤트의 이름</ko>\n     * @param {Object} customEvent Event data to be sent when triggering a custom event <ko>커스텀 이벤트가 발생할 때 전달할 데이터</ko>\n     * @return {Boolean} Indicates whether the event has occurred. If the stop() method is called by a custom event handler, it will return false and prevent the event from occurring. <a href=\"https://github.com/naver/egjs-component/wiki/How-to-make-Component-event-design%3F\">Ref</a> <ko>이벤트 발생 여부. 커스텀 이벤트 핸들러에서 stop() 메서드를 호출하면 'false'를 반환하고 이벤트 발생을 중단한다. <a href=\"https://github.com/naver/egjs-component/wiki/How-to-make-Component-event-design%3F\">참고</a></ko>\n     * @example\n    class Some extends eg.Component {\n     some(){\n     \tif(this.trigger(\"beforeHi\")){ // When event call to stop return false.\n    \tthis.trigger(\"hi\");// fire hi event.\n     \t}\n     }\n    }\n    const some = new Some();\n    some.on(\"beforeHi\", (e) => {\n    if(condition){\n    \te.stop(); // When event call to stop, `hi` event not call.\n    }\n    });\n    some.on(\"hi\", (e) => {\n    // `currentTarget` is component instance.\n    console.log(some === e.currentTarget); // true\n    });\n    // If you want to more know event design. You can see article.\n    // https://github.com/naver/egjs-component/wiki/How-to-make-Component-event-design%3F\n     */\n\n\n    var _proto = Component.prototype;\n\n    _proto.trigger = function trigger(eventName, customEvent) {\n      if (customEvent === void 0) {\n        customEvent = {};\n      }\n\n      var handlerList = this._eventHandler[eventName] || [];\n      var hasHandlerList = handlerList.length > 0;\n\n      if (!hasHandlerList) {\n        return true;\n      } // If detach method call in handler in first time then handler list calls.\n\n\n      handlerList = handlerList.concat();\n      customEvent.eventType = eventName;\n      var isCanceled = false;\n      var arg = [customEvent];\n      var i = 0;\n\n      customEvent.stop = function () {\n        isCanceled = true;\n      };\n\n      customEvent.currentTarget = this;\n\n      for (var _len = arguments.length, restParam = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n        restParam[_key - 2] = arguments[_key];\n      }\n\n      if (restParam.length >= 1) {\n        arg = arg.concat(restParam);\n      }\n\n      for (i = 0; handlerList[i]; i++) {\n        handlerList[i].apply(this, arg);\n      }\n\n      return !isCanceled;\n    };\n    /**\n     * Executed event just one time.\n     * @ko 이벤트가 한번만 실행된다.\n     * @param {eventName} eventName The name of the event to be attached <ko>등록할 이벤트의 이름</ko>\n     * @param {Function} handlerToAttach The handler function of the event to be attached <ko>등록할 이벤트의 핸들러 함수</ko>\n     * @return {eg.Component} An instance of a component itself<ko>컴포넌트 자신의 인스턴스</ko>\n     * @example\n    class Some extends eg.Component {\n     hi() {\n       alert(\"hi\");\n     }\n     thing() {\n       this.once(\"hi\", this.hi);\n     }\n    }\n    var some = new Some();\n    some.thing();\n    some.trigger(\"hi\");\n    // fire alert(\"hi\");\n    some.trigger(\"hi\");\n    // Nothing happens\n     */\n\n\n    _proto.once = function once(eventName, handlerToAttach) {\n      if (typeof eventName === \"object\" && isUndefined(handlerToAttach)) {\n        var eventHash = eventName;\n        var i;\n\n        for (i in eventHash) {\n          this.once(i, eventHash[i]);\n        }\n\n        return this;\n      } else if (typeof eventName === \"string\" && typeof handlerToAttach === \"function\") {\n        var self = this;\n        this.on(eventName, function listener() {\n          for (var _len2 = arguments.length, arg = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            arg[_key2] = arguments[_key2];\n          }\n\n          handlerToAttach.apply(self, arg);\n          self.off(eventName, listener);\n        });\n      }\n\n      return this;\n    };\n    /**\n     * Checks whether an event has been attached to a component.\n     * @ko 컴포넌트에 이벤트가 등록됐는지 확인한다.\n     * @param {String} eventName The name of the event to be attached <ko>등록 여부를 확인할 이벤트의 이름</ko>\n     * @return {Boolean} Indicates whether the event is attached. <ko>이벤트 등록 여부</ko>\n     * @example\n    class Some extends eg.Component {\n     some() {\n       this.hasOn(\"hi\");// check hi event.\n     }\n    }\n     */\n\n\n    _proto.hasOn = function hasOn(eventName) {\n      return !!this._eventHandler[eventName];\n    };\n    /**\n     * Attaches an event to a component.\n     * @ko 컴포넌트에 이벤트를 등록한다.\n     * @param {eventName} eventName The name of the event to be attached <ko>등록할 이벤트의 이름</ko>\n     * @param {Function} handlerToAttach The handler function of the event to be attached <ko>등록할 이벤트의 핸들러 함수</ko>\n     * @return {eg.Component} An instance of a component itself<ko>컴포넌트 자신의 인스턴스</ko>\n     * @example\n    class Some extends eg.Component {\n     hi() {\n       console.log(\"hi\");\n     }\n     some() {\n       this.on(\"hi\",this.hi); //attach event\n     }\n    }\n    */\n\n\n    _proto.on = function on(eventName, handlerToAttach) {\n      if (typeof eventName === \"object\" && isUndefined(handlerToAttach)) {\n        var eventHash = eventName;\n        var name;\n\n        for (name in eventHash) {\n          this.on(name, eventHash[name]);\n        }\n\n        return this;\n      } else if (typeof eventName === \"string\" && typeof handlerToAttach === \"function\") {\n        var handlerList = this._eventHandler[eventName];\n\n        if (isUndefined(handlerList)) {\n          this._eventHandler[eventName] = [];\n          handlerList = this._eventHandler[eventName];\n        }\n\n        handlerList.push(handlerToAttach);\n      }\n\n      return this;\n    };\n    /**\n     * Detaches an event from the component.\n     * @ko 컴포넌트에 등록된 이벤트를 해제한다\n     * @param {eventName} eventName The name of the event to be detached <ko>해제할 이벤트의 이름</ko>\n     * @param {Function} handlerToDetach The handler function of the event to be detached <ko>해제할 이벤트의 핸들러 함수</ko>\n     * @return {eg.Component} An instance of a component itself <ko>컴포넌트 자신의 인스턴스</ko>\n     * @example\n    class Some extends eg.Component {\n     hi() {\n       console.log(\"hi\");\n     }\n     some() {\n       this.off(\"hi\",this.hi); //detach event\n     }\n    }\n     */\n\n\n    _proto.off = function off(eventName, handlerToDetach) {\n      // All event detach.\n      if (isUndefined(eventName)) {\n        this._eventHandler = {};\n        return this;\n      } // All handler of specific event detach.\n\n\n      if (isUndefined(handlerToDetach)) {\n        if (typeof eventName === \"string\") {\n          this._eventHandler[eventName] = undefined;\n          return this;\n        } else {\n          var eventHash = eventName;\n          var name;\n\n          for (name in eventHash) {\n            this.off(name, eventHash[name]);\n          }\n\n          return this;\n        }\n      } // The handler of specific event detach.\n\n\n      var handlerList = this._eventHandler[eventName];\n\n      if (handlerList) {\n        var k;\n        var handlerFunction;\n\n        for (k = 0; (handlerFunction = handlerList[k]) !== undefined; k++) {\n          if (handlerFunction === handlerToDetach) {\n            handlerList = handlerList.splice(k, 1);\n            break;\n          }\n        }\n      }\n\n      return this;\n    };\n\n    return Component;\n  }();\n\n  Component.VERSION = \"2.1.2\";\n  return Component;\n}();\n\nexport default Component;\n//# sourceMappingURL=component.esm.js.map\n","import { ArrayFormat, InnerSizeType, ClientSizeType, ScrollSizeType, OffsetSizeType } from \"./types\";\n\nimport { SUPPORT_ADDEVENTLISTENER, SUPPORT_COMPUTEDSTYLE } from \"./consts\";\n\nexport function getAttribute(el: HTMLElement, name: string) {\n  return el.getAttribute(name) || \"\";\n}\n\nexport function toArray<T>(arr: ArrayFormat<T>): T[] {\n  return [].slice.call(arr);\n}\nexport function isDataAttribute(target: HTMLElement, prefix: string = \"data-\"): boolean {\n  return !!target.getAttribute(`${prefix}width`);\n}\nexport function addEvent(\n  element: Element | Window,\n  type: string,\n  handler: (...args: any[]) => void,\n) {\n  if (SUPPORT_ADDEVENTLISTENER) {\n    element.addEventListener(type, handler, false);\n  } else if ((element as any).attachEvent) {\n    (element as any).attachEvent(`on${type}`, handler);\n  } else {\n    (element as any)[`on${type}`] = handler;\n  }\n}\nexport function removeEvent(\n  element: Element | Window,\n  type: string,\n  handler: (...args: any[]) => void,\n) {\n  if (element.removeEventListener) {\n    element.removeEventListener(type, handler, false);\n  } else if ((element as any).detachEvent) {\n    (element as any).detachEvent(`on${type}`, handler);\n  } else {\n    (element as any)[`on${type}`] = null;\n  }\n}\n\nexport function innerWidth(el: HTMLElement) {\n  return getSize(el, \"Width\");\n}\nexport function innerHeight(el: HTMLElement) {\n  return getSize(el, \"Height\");\n}\nexport function getStyles(el: Element) {\n  return (SUPPORT_COMPUTEDSTYLE ?\n    window.getComputedStyle(el) : (el as any).currentStyle) || {};\n}\nfunction getSize(el: HTMLElement, name: \"Width\" | \"Height\") {\n  const size = el[`client${name}` as ClientSizeType] || el[`offset${name}` as OffsetSizeType];\n\n  return parseFloat(size || getStyles(el)[name.toLowerCase()]) || 0;\n}\n","import { addEvent, removeEvent, innerWidth, innerHeight, getAttribute } from \"./utils\";\nimport { WIDTH, HEIGHT } from \"./consts\";\nimport { AutoSizerElement } from \"./types\";\n\nconst elements: AutoSizerElement[] = [];\n\nexport function add(element: AutoSizerElement, prefix: string) {\n  !elements.length && addEvent(window, \"resize\", resizeAll);\n  element.__PREFIX__ = prefix;\n  elements.push(element);\n  resize(element);\n}\nexport function remove(element: AutoSizerElement, prefix: string) {\n  const index = elements.indexOf(element);\n\n  if (index < 0) {\n    return;\n  }\n  const fixed = getAttribute(element, `${prefix}fixed`);\n\n  delete element.__PREFIX__;\n  element.style[fixed === HEIGHT ? WIDTH : HEIGHT] = \"\";\n  elements.splice(index, 1);\n  !elements.length && removeEvent(window, \"resize\", resizeAll);\n}\nfunction resize(element: AutoSizerElement, prefix = \"data-\") {\n  let elementPrefix = element.__PREFIX__;\n\n  if (typeof elementPrefix !== \"string\") {\n    elementPrefix = prefix;\n  }\n  const dataWidth = parseInt(getAttribute(element, `${elementPrefix}${WIDTH}`), 10) || 0;\n  const dataHeight = parseInt(getAttribute(element, `${elementPrefix}${HEIGHT}`), 10) || 0;\n  const fixed = getAttribute(element, `${elementPrefix}fixed`);\n\n  if (fixed === HEIGHT) {\n    const size = innerHeight(element) || dataHeight;\n\n    element.style[WIDTH] = `${dataWidth / dataHeight * size}px`;\n  } else {\n    const size = innerWidth(element) || dataWidth;\n\n    element.style[HEIGHT] = `${dataHeight / dataWidth * size}px`;\n  }\n}\nexport function resizeAll() {\n  elements.forEach(element => {\n    resize(element);\n  });\n}\n","import { IS_IE } from \"./consts\";\nimport Component from \"@egjs/component\";\nimport { toArray, isDataAttribute, removeEvent, addEvent } from \"./utils\";\nimport { remove as removeAutoSizer, add as addAutoSizer } from \"./AutoSizer\";\n\n/**\n * @namespace eg.LazyLoaded\n */\n/**\n * This module is used to wait for images or videos to load.\n * @ko 이 모듈은 이미지 또는 비디오 로딩을 대기할 수 있습니다.\n * @memberof eg.LazyLoaded\n * @param -\n * @example\n * ## HTML\n * ```html\n * <div>\n *    <img src=\"./1.jpg\" data-width=\"1280\" data-height=\"853\" style=\"width:100%\"/>\n *    <img src=\"./2.jpg\">\n *    <img src=\"./3.jpg\">\n *    <img src=\"./4.jpg\">\n *    <img src=\"ERR\">\n *    <img src=\"./6.jpg\">\n *    <img src=\"./7.jpg\">\n *    <img src=\"ERR\">\n * </div>\n * ```\n * ## Javascript\n * ```js\n * import {check} from \"@egjs/lazyloaded\";\n *\n * eg.LazyLoaded.check([document.querySelector(\"div\")]).on({\n *   ready: () => console.log(\"ready\"),\n *   finish: () => console.log(\"finish\"),\n *   error: e => console.log(\"error\", e),\n * });\n * ```\n */\nexport function check(\n  elements: HTMLElement[],\n  prefix: string = \"data-\",\n): Component {\n  const component = new Component();\n  let finishCount = 0;\n  let readyCount = 0;\n\n  function checkReady() {\n    if (--readyCount !== 0) {\n      return;\n    }\n    /**\n     * An event occurs when the size of all images is available.\n     * @ko 모든 이미지의 사이즈를 구할 수 있는 상태가 된 경우 이벤트가 발생한다.\n     * @event eg.LazyLoaded#ready\n     * @example\n     * ```html\n     * <div>\n     *    <img src=\"./1.jpg\" data-width=\"1280\" data-height=\"853\" style=\"width:100%\"/>\n     *    <img src=\"./2.jpg\"/>\n     *    <img src=\"ERR\"/>\n     * </div>\n     * ```\n     * ## Javascript\n     * ```js\n     * import {check} from \"@egjs/lazyloaded\";\n     *\n     * eg.LazyLoaded.check([document.querySelector(\"div\")]).on({\n     *   ready: () => console.log(\"ready\"),\n     * });\n     * ```\n     */\n    component.trigger(\"ready\");\n  }\n  function checkFinish() {\n    if (--finishCount !== 0) {\n      return;\n    }\n    /**\n     * An event occurs when all images have been completed loading.\n     * @ko 모든 이미지가 로딩이 완료된 상태가 된 경우 이벤트가 발생한다.\n     * @event eg.LazyLoaded#finish\n     * @example\n     * ```html\n     * <div>\n     *    <img src=\"./1.jpg\" data-width=\"1280\" data-height=\"853\" style=\"width:100%\"/>\n     *    <img src=\"./2.jpg\"/>\n     *    <img src=\"ERR\"/>\n     * </div>\n     * ```\n     * ## Javascript\n     * ```js\n     * import {check} from \"@egjs/lazyloaded\";\n     *\n     * eg.LazyLoaded.check([document.querySelector(\"div\")]).on({\n     *   finish: () => console.log(\"finish\"),\n     * });\n     * ```\n     */\n    component.trigger(\"finish\");\n  }\n  elements.forEach((el, i) => {\n    const tagName = el.tagName;\n\n    if (isDataAttribute(el, prefix) && tagName !== \"IMG\") {\n      addAutoSizer(el, prefix);\n      ++finishCount;\n      setTimeout(() => {\n        check(toArray(el.querySelectorAll(\"img\")), prefix).on(\"finish\", () => {\n          removeAutoSizer(el, prefix);\n          checkFinish();\n        });\n      });\n      return;\n    }\n    const images = tagName === \"IMG\" ? [el as HTMLImageElement] : toArray(el.querySelectorAll(\"img\"));\n\n    if (!images.length) {\n      return;\n    }\n    images.forEach((img, j) => {\n      if (img.complete && (!IS_IE || (IS_IE && img.naturalWidth))) {\n        if (!img.naturalWidth) {\n          setTimeout(() => {\n            component.trigger(\"error\", {\n              itemTarget: el,\n              itemIndex: i,\n              target: img,\n              index: j,\n            });\n          });\n        }\n        return;\n      }\n      if (isDataAttribute(img, prefix)) {\n        addAutoSizer(img, prefix);\n      } else {\n        ++readyCount;\n      }\n      ++finishCount;\n\n      function onError() {\n        /**\n         * An event occurs if the image fails to load.\n         * @ko 이미지가 로딩에 실패하면 이벤트가 발생한다.\n         * @event eg.LazyLoaded#error\n         * @param {object} e - The object of data to be sent to an event <ko>이벤트에 전달되는 데이터 객체</ko>\n         * @param {HTMLElement} [e.itemTarget] - The item's element with error images.<ko>오류난 이미지가 있는 아이템의 엘리먼트</ko>\n         * @param {number} [e.itemindex] - The item's index with error images. <ko>오류난 이미지가 있는 아이템의 인덱스</ko>\n         * @param {HTMLElement} [e.target] - Error image element <ko>오류난 이미지 엘리먼트</ko>\n         * @param {number} [e.index] - Error image index <ko>오류난 이미지의 인덱스</ko>\n         * @example\n         * ```html\n         * <div>\n         *    <img src=\"./1.jpg\" data-width=\"1280\" data-height=\"853\" style=\"width:100%\"/>\n         *    <img src=\"./2.jpg\"/>\n         *    <img src=\"ERR\"/>\n         * </div>\n         * ```\n         * ## Javascript\n         * ```js\n         * import {check} from \"@egjs/lazyloaded\";\n         *\n         * eg.LazyLoaded.check([document.querySelector(\"div\")]).on({\n         *   error: e => {\n         *     // <div>...</div>, 0, <img src=\"ERR\"/>, 2\n         *     console.log(e.itemTarget, e.itemIndex, e.target, e.index),\n         *   },\n         * });\n         * ```\n         */\n        component.trigger(\"error\", {\n          itemTarget: el,\n          itemIndex: i,\n          target: img,\n          index: j,\n        });\n      }\n      function onCheck(e: Event) {\n        const target = (e.target || e.srcElement) as HTMLImageElement;\n\n        removeEvent(target, \"error\", onCheck);\n        removeEvent(target, \"load\", onCheck);\n\n        if (isDataAttribute(target, prefix)) {\n          removeAutoSizer(target, prefix);\n        } else {\n          checkReady();\n        }\n        if (e.type === \"error\") {\n          onError();\n        }\n        checkFinish();\n      }\n      addEvent(img, \"load\", onCheck);\n      addEvent(img, \"error\", onCheck);\n\n      IS_IE && img.setAttribute(\"src\", img.getAttribute(\"src\") as string);\n    });\n  });\n\n  !readyCount && setTimeout(() => {\n    component.trigger(\"ready\");\n  });\n\n  !finishCount && setTimeout(() => {\n    component.trigger(\"finish\");\n  });\n\n  return component;\n}\n\n\n/**\n * Remove the element that was registered in AutoSizer.\n * @ko AutoSizer에 등록됐던 엘리먼트를 제거 한다.\n * @memberof eg.LazyLoaded\n * @function removeAutoSizer\n * @param {HTMLElement} element - Element to be removed\n * @param {string} prefix - data prefix of element to be removed\n * @example\n * ## HTML\n * ```html\n * <div>\n *    <img src=\"./1.jpg\" data-width=\"1280\" data-height=\"853\" style=\"width:100%\"/>\n * </div>\n * ```\n * ## Javascript\n * ```js\n * import { removeAutoSizer } from \"@egjs/lazyloaded\";\n *\n * if (target.getAttribute(\"data-width\")) {\n *   removeAutoSizer(target, \"data-\");\n * }\n * ```\n */\nexport { removeAutoSizer };\n"],"names":["isWindow","window","ua","navigator","userAgent","SUPPORT_COMPUTEDSTYLE","IS_IE","test","SUPPORT_ADDEVENTLISTENER","document","WIDTH","HEIGHT","isUndefined","value","Component","_eventHandler","options","_proto","prototype","trigger","eventName","customEvent","handlerList","hasHandlerList","length","concat","eventType","isCanceled","arg","i","stop","currentTarget","_len","arguments","restParam","Array","_key","apply","once","handlerToAttach","eventHash","self","on","listener","_len2","_key2","off","hasOn","name","push","handlerToDetach","undefined","k","handlerFunction","splice","VERSION","el","getAttribute","arr","slice","call","target","prefix","element","type","handler","addEventListener","attachEvent","removeEventListener","detachEvent","getSize","getComputedStyle","currentStyle","size","parseFloat","getStyles","toLowerCase","elements","addEvent","resizeAll","__PREFIX__","resize","index","indexOf","fixed","style","removeEvent","elementPrefix","dataWidth","parseInt","dataHeight","innerHeight","innerWidth","forEach","component","finishCount","readyCount","tagName","isDataAttribute","addAutoSizer","setTimeout","check","toArray","querySelectorAll","removeAutoSizer","checkFinish","images","img","j","complete","naturalWidth","itemTarget","itemIndex","e","srcElement","onCheck","checkReady","onError","setAttribute"],"mappings":"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"}